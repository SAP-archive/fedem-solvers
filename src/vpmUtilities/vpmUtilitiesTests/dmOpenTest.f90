!! SPDX-FileCopyrightText: 2023 SAP SE
!!
!! SPDX-License-Identifier: Apache-2.0
!!
!! This file is part of FEDEM - https://openfedem.org
!!==============================================================================

!! Test program for dmOpen.
!! Writes a file test_B.fmx containing <m>x<n> doubles.
!!
!! $ dmOpenTest <m> <n>
!!
!! Written by: Knut M. Okstad 01.09.2006

program test

  use diskMatrixModule

  implicit none

  integer :: ierr, nRow, nCol, cs = 0
  type(diskMatrixType) :: BmatDisk
  character(len=16) :: cArg

  if (iargc() > 1) then
     call getarg(1,cArg)
     read(cArg,*) nRow
     call getarg(2,cArg)
     read(cArg,*) nCol
     print*,'Number of words to write',nRow,nCol,int(nRow,i8)*int(nCol,i8)
  else
     call usage('<m> <n>')
  end if

  call dmOpen (BmatDisk,'test_B.fmx',cs,nRow,nCol,dmNdp_p,ierr,nColSwap=1)
  if (ierr < 0) stop 'dmOpen failed'

  call dmClose (BmatDisk,ierr)
  if (ierr < 0) stop 'dmClose failed'

  print*,'Success'

end program test
